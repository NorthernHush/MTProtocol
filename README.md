<h1 align="center">
  ๐ <b>MESH SECURITY LABS</b> ๐
</h1>

<h3 align="center">
  <i>ะะฝะพะฝะธะผะฝะพััั. ะะตะทะพะฟะฐัะฝะพััั. ะะพะฝััะพะปั.</i>
</h3>

<p align="center">
  <img src="https://img.shields.io/badge/Status-Open_Source-blue?style=for-the-badge&logo=github"/>
  <img src="https://img.shields.io/badge/Encryption-E2EE-green?style=for-the-badge&logo=lock"/>
  <img src="https://img.shields.io/badge/Protocol-Double_Ratchet-purple?style=for-the-badge&logo=cryptography"/>
</p>

# ๐งฉ MeshRatchet Protocol โ ะัะธะฟัะพะณัะฐัะธัะตัะบะพะต ัะดัะพ ะฐะฝะพะฝะธะผะฝะพะณะพ P2P-ะผะตััะตะฝะดะถะตัะฐ

<p align="center">
  ๐โโโ๐โโโ๐ก๏ธโโโ๐ต๏ธโโ๏ธโโโ๐งฉ<br>
  โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ<br>
  ๐งฉโโโ๐ต๏ธโโ๏ธโโโ๐ก๏ธโโโ๐โโโ๐<br>
  โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โ<br>
  ๐โโโ๐ก๏ธโโโ๐ต๏ธโโ๏ธโโโ๐งฉโโโ๐
</p>

> โ **ะญัะพั ัะตะฟะพะทะธัะพัะธะน ัะฒะปัะตััั ะฟัะฑะปะธัะฝัะผ ะธ ะฟัะตะดะฝะฐะทะฝะฐัะตะฝ ะดะปั ะฒัะตั ัะฐะทัะฐะฑะพััะธะบะพะฒ, ะธััะปะตะดะพะฒะฐัะตะปะตะน ะธ ัะฝััะทะธะฐััะพะฒ, ะทะฐะธะฝัะตัะตัะพะฒะฐะฝะฝัั ะฒ ะฟัะธะฒะฐัะฝัั ะธ ะฑะตะทะพะฟะฐัะฝัั ะบะพะผะผัะฝะธะบะฐัะธัั.**

**MeshRatchet Protocol** โ ััะพ ะพัะบัััะฐั, ะฒััะพะบะพะฝะฐะดัะถะฝะฐั ัะตะฐะปะธะทะฐัะธั ะฟัะพัะพะบะพะปะฐ ะดะฒะพะนะฝะพะณะพ ััััะตัะฐ (Double Ratchet) ะฝะฐ ัะทัะบะต **C**, ัะฐะทัะฐะฑะพัะฐะฝะฝะฐั ะบะฐะบ ะบัะธะฟัะพะณัะฐัะธัะตัะบะธะน ััะฝะดะฐะผะตะฝั ะดะปั ะฐะฝะพะฝะธะผะฝะพะณะพ P2P-ะผะตััะตะฝะดะถะตัะฐ **Mesh**.  

ะัะพะตะบั ะพัะธะตะฝัะธัะพะฒะฐะฝ ะฝะฐ:
- **ะะพะปะฝัะน ะบะพะฝััะพะปั ะฝะฐะด ะดะฐะฝะฝัะผะธ**: ะฒัะต ะพะฟะตัะฐัะธะธ ัะธััะพะฒะฐะฝะธั ะธ ัะฟัะฐะฒะปะตะฝะธั ะบะปััะฐะผะธ ะฟัะพะธััะพะดัั ะปะพะบะฐะปัะฝะพ.
- **ะะฐะบัะธะผะฐะปัะฝัั ัััะพะนัะธะฒะพััั ะบ ะบะพะผะฟัะพะผะตัะฐัะธะธ**: forward secrecy ะธ post-compromise security ะฟะพ ัะผะพะปัะฐะฝะธั.
- **ะัะพะทัะฐัะฝะพััั ะธ ะฐัะดะธััะตะผะพััั**: ะพัะบััััะน ะธััะพะดะฝัะน ะบะพะด ะฟะพะทะฒะพะปัะตั ะฝะตะทะฐะฒะธัะธะผะพ ะฟัะพะฒะตัะธัั ะฑะตะทะพะฟะฐัะฝะพััั.

ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ:
- **C99** โ ะดะปั ะบัะธะฟัะพะณัะฐัะธัะตัะบะพะณะพ ัะดัะฐ ะธ ัะฐะฑะพัั ั ะฟะฐะผัััั  
- **OpenSSL 3.0+** โ ะดะปั X25519, HKDF, ChaCha20-Poly1305  
- **Python 3.6+** โ ะดะปั ะฒัะฟะพะผะพะณะฐัะตะปัะฝัั ะธะฝััััะผะตะฝัะพะฒ: ัะฑะพัะบะธ (`meshprotocol.py`), ัะตััะธัะพะฒะฐะฝะธั ะธ ะพัะปะฐะดะบะธ  

ะญัะพั ะฟัะพัะพะบะพะป โ ะฝะต ะฟัะพััะพ ะฑะธะฑะปะธะพัะตะบะฐ. ะญัะพ **ะณะฐัะฐะฝัะธั ะฟัะธะฒะฐัะฝะพััะธ**, ะฟะพัััะพะตะฝะฝะฐั ะฝะฐ ะฟัะธะฝัะธะฟะฐั ะพัะบัััะพััะธ ะธ ะดะพะฒะตัะธั ัะตัะตะท ะฟัะพะฒะตััะตะผะพััั.

**MeshRatchet** โ ััะพ ะปะตะณะบะพะฒะตัะฝะฐั ะฑะธะฑะปะธะพัะตะบะฐ ะฝะฐ C, ัะตะฐะปะธะทัััะฐั ะฑะตะทะพะฟะฐัะฝัะน ะบัะธะฟัะพะณัะฐัะธัะตัะบะธะน ะฟัะพัะพะบะพะป ะพะฑะผะตะฝะฐ ัะพะพะฑัะตะฝะธัะผะธ ั ะดะฒะพะนะฝัะผ ััััะตัะพะผ (Double Ratchet), ะพะฑะตัะฟะตัะธะฒะฐััะธะน **forward secrecy** ะธ **post-compromise security**. ะะธะฑะปะธะพัะตะบะฐ ัะฐะทัะฐะฑะพัะฐะฝะฐ ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฒ ะผะตััะตะฝะดะถะตัะฐั, IoT-ััััะพะนััะฒะฐั ะธ ะดััะณะธั ะฟัะธะปะพะถะตะฝะธัั, ะณะดะต ะฒะฐะถะฝั ะบะพะฝัะธะดะตะฝัะธะฐะปัะฝะพััั ะธ ัะตะปะพััะฝะพััั ะฟะตัะตะฟะธัะบะธ.

> **ะะตััะธั**: `v0.1`  
> **ะะฒัะพั**: Mesh Security Labs  
> **Telegram**: [@mesh_im](https://t.me/mesh_im)

---

## ๐ ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

- **ะะฒะพะนะฝะพะน ััััะตั (Double Ratchet)**: ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ะบะปััะตะน ะฟัะธ ะบะฐะถะดะพะผ ัะพะพะฑัะตะฝะธะธ.
- **Forward Secrecy**: ะบะพะผะฟัะพะผะตัะฐัะธั ะดะพะปะณะพััะพัะฝะพะณะพ ะบะปััะฐ ะฝะต ัะฐัะบััะฒะฐะตั ะฟัะพัะปัะต ัะพะพะฑัะตะฝะธั.
- **Post-Compromise Security**: ะดะฐะถะต ะฟัะธ ััะตัะบะต ัะตะบััะธั ะบะปััะตะน ัะตััะธั ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะฑะตะทะพะฟะฐัะฝะพััั ัะพ ะฒัะตะผะตะฝะตะผ.
- **ะัะพะฒะตัะบะฐ ัะตะปะพััะฝะพััะธ ะธ ะฟะพะดะปะธะฝะฝะพััะธ**: ัะธััะพะฒะฐะฝะธะต ั ะฐััะตะฝัะธัะธะบะฐัะธะตะน (AEAD) ัะตัะตะท **ChaCha20-Poly1305**.
- **ะะธะฑะบะฐั ะบะพะฝัะธะณััะฐัะธั**: ะฝะฐัััะพะนะบะฐ ัะฐะทะผะตัะฐ ัะพะพะฑัะตะฝะธะน, ะธะฝัะตัะฒะฐะปะพะฒ ะพะฑะฝะพะฒะปะตะฝะธั ะบะปััะตะน, ะปะพะณะธัะพะฒะฐะฝะธั ะธ ะณะตะฝะตัะฐัะธะธ ัะปััะฐะนะฝัั ัะธัะตะป.
- **ะะตะทะพะฟะฐัะฝะฐั ะพัะธััะบะฐ ะฟะฐะผััะธ**: ััะฒััะฒะธัะตะปัะฝัะต ะดะฐะฝะฝัะต (ะบะปััะธ, ัะตะบัะตัั) ะพะฑะฝัะปััััั ะฟะพัะปะต ะธัะฟะพะปัะทะพะฒะฐะฝะธั.
- **ะะพะดะดะตัะถะบะฐ ัะตัะธะฐะปะธะทะฐัะธะธ ะธ ะฟะฐะบะตัะฝัั ะพะฟะตัะฐัะธะน** (ะพะฟัะธะพะฝะฐะปัะฝะพ).

---

## ๐งฐ ะขัะตะฑะพะฒะฐะฝะธั

- **OpenSSL 3.0+** (ะดะปั X25519, HKDF, ChaCha20-Poly1305)
- Python 3.6+
- ะะพะผะฟะธะปััะพั C99 ะธะปะธ ะฝะพะฒะตะต
- POSIX-ัะพะฒะผะตััะธะผะฐั ัะธััะตะผะฐ (ะดะปั `time()`)

---

## ๐ฆ ะฃััะฐะฝะพะฒะบะฐ ะธ ัะฑะพัะบะฐ

MeshRatchet ะฟะพััะฐะฒะปัะตััั ั ัะดะพะฑะฝัะผ Python-ัะบัะธะฟัะพะผ `meshprotocol.py`, ะบะพัะพััะน ะฐะฒัะพะผะฐัะธะทะธััะตั ัะฑะพัะบั ะฑะธะฑะปะธะพัะตะบะธ ะธ ะฟัะธะผะตัะพะฒ.

### ะขัะตะฑะพะฒะฐะฝะธั
- Python 3.6+
- OpenSSL 3.0+ (ั ะทะฐะณะพะปะพะฒะพัะฝัะผะธ ัะฐะนะปะฐะผะธ)
- ะะพะผะฟะธะปััะพั C (gcc/clang)

### ะััััะฐั ัะฑะพัะบะฐ
```bash
# ะกะฑะพัะบะฐ ะพัะฝะพะฒะฝะพะน ะฑะธะฑะปะธะพัะตะบะธ
python3 meshprotocol.py build

# ะกะฑะพัะบะฐ ั ะฟัะธะผะตัะฐะผะธ
python3 meshprotocol.py build --with-examples

# ะฃััะฐะฝะพะฒะบะฐ ะฒ ัะธััะตะผั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
sudo python3 meshprotocol.py install
 
# ะัะพะฒะตัะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
python3 meshprotocol.py check

# ะะฐะฟััะบ ัะตััะพะฒ (ะตัะปะธ ะตััั)
python3 meshprotocol.py test

# ะะตะฝะตัะฐัะธั ะดะพะบัะผะตะฝัะฐัะธะธ
python3 meshprotocol.py docs

# ะัะธััะบะฐ ัะฑะพัะพัะฝัั ะฐััะตัะฐะบัะพะฒ
python3 meshprotocol.py clean
```
> ๐ก ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฑะฝะฐััะถะธั OpenSSL ะธ ะฝะฐัััะพะธั ัะปะฐะณะธ ะบะพะผะฟะธะปััะธะธ. ะัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ ะผะพะถะฝะพ ัะบะฐะทะฐัั ะฟััั ะฒัััะฝัั:  
> `python3 meshprotocol.py build --openssl-path /usr/local/ssl`

### ๐ ะัััััะน ััะฐัั
```C
#include "meshratchet.h"

int main() {
    // ะะฝะธัะธะฐะปะธะทะฐัะธั ะบะพะฝัะตะบััะฐ
    mr_ctx_t* ctx = mr_init();
    if (!ctx) return -1;

    // ะะตะฝะตัะฐัะธั ะบะปััะตะน
    mr_key_pair_t* alice_keys = mr_generate_key_pair(ctx);
    mr_key_pair_t* bob_keys = mr_generate_key_pair(ctx);

    // ะกะพะทะดะฐะฝะธะต ัะตััะธะน
    mr_session_t* alice_session, *bob_session;
    mr_session_create(ctx, alice_keys, bob_keys->public_key, 32, &alice_session);
    mr_session_create(ctx, bob_keys, alice_keys->public_key, 32, &bob_session);

    // ะจะธััะพะฒะฐะฝะธะต
    uint8_t plaintext[] = "Hello, Bob!";
    uint8_t ciphertext[1024];
    size_t ct_len;
    mr_encrypt(alice_session, MR_MSG_TEXT, plaintext, strlen((char*)plaintext),
               ciphertext, sizeof(ciphertext), &ct_len);

    // ะะฐััะธััะพะฒะบะฐ
    uint8_t decrypted[1024];
    size_t pt_len;
    mr_msg_type_t msg_type;
    mr_decrypt(bob_session, ciphertext, ct_len, decrypted, sizeof(decrypted), &pt_len, &msg_type);

    // ะัะธััะบะฐ
    mr_session_free(alice_session);
    mr_session_free(bob_session);
    mr_free_key_pair(alice_keys);
    mr_free_key_pair(bob_keys);
    mr_cleanup(ctx);

    return 0;
}
```
### โ๏ธ ะะพะฝัะธะณััะฐัะธั
```C
mr_config_t config;
mr_get_default_config(&config);
config.max_message_size = 4096;        // ะะฐะบั. ัะฐะทะผะตั ัะพะพะฑัะตะฝะธั (ะฑะฐะนั)
config.key_update_interval = 100;      // ะะฑะฝะพะฒะปััั ะบะปััะธ ะบะฐะถะดัะต 100 ัะพะพะฑัะตะฝะธะน
config.max_skip_keys = 1000;           // ะะฐะบั. ะฟัะพะฟััะบ ัะพะพะฑัะตะฝะธะน ะฟัะธ ัะฐััะธััะพะฒะบะต
config.enable_serialization = 0;       // ะัะบะปััะธัั ัะตัะธะฐะปะธะทะฐัะธั (ะตัะปะธ ะฝะต ะฝัะถะฝะฐ)

mr_ctx_t* ctx = mr_init_ex(&config);
```
## ๐ ะัะธะฟัะพะณัะฐัะธัะตัะบะธะต ะฟัะธะผะธัะธะฒั

MeshRatchet ะฟะพัััะพะตะฝ ะฝะฐ ะฟัะพะฒะตัะตะฝะฝัั ะธ ัะพะฒัะตะผะตะฝะฝัั ะบัะธะฟัะพะณัะฐัะธัะตัะบะธั ะฐะปะณะพัะธัะผะฐั:

| ะะพะผะฟะพะฝะตะฝั           | ะะปะณะพัะธัะผ                     | ะะฐะทะฝะฐัะตะฝะธะต                                  |
|---------------------|------------------------------|---------------------------------------------|
| **ะะฑะผะตะฝ ะบะปััะฐะผะธ**   | `X25519` (Elliptic Curve DH) | ะะตะทะพะฟะฐัะฝะพะต ัะพะณะปะฐัะพะฒะฐะฝะธะต ะพะฑัะตะณะพ ัะตะบัะตัะฐ       |
| **ะัะพะธะทะฒะพะดะฝะฐั ััะฝะบัะธั** | `HKDF-SHA256`            | ะะตะฝะตัะฐัะธั ะบัะธะฟัะพะณัะฐัะธัะตัะบะธั ะบะปััะตะน ะธะท ัะตะบัะตัะพะฒ |
| **ะจะธััะพะฒะฐะฝะธะต**      | `ChaCha20-Poly1305` (AEAD)   | ะััะตะฝัะธัะธัะธัะพะฒะฐะฝะฝะพะต ัะธััะพะฒะฐะฝะธะต ัะพะพะฑัะตะฝะธะน    |
| **ะัััะตั-ััะฝะบัะธั**  | `HMAC-SHA256`                | ะะดะฝะพััะพัะพะฝะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต ัะตะฟะพัะตะบ ะบะปััะตะน     |

ะัะต ะฟัะธะผะธัะธะฒั ัะพะพัะฒะตัััะฒััั ัะตะบะพะผะตะฝะดะฐัะธัะผ IETF ะธ Signal Protocol.

---

## ๐ ะัะฑะปะธัะฝัะน API

ะะธะฑะปะธะพัะตะบะฐ ะฟัะตะดะพััะฐะฒะปัะตั ะฟัะพััะพะน ะธ ะฑะตะทะพะฟะฐัะฝัะน C API:

- **`mr_init()` / `mr_init_ex()`**  
  ะะฝะธัะธะฐะปะธะทะฐัะธั ะบะพะฝัะตะบััะฐ ั ะฝะฐัััะพะนะบะฐะผะธ ะฟะพ ัะผะพะปัะฐะฝะธั ะธะปะธ ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะผะธ ะฟะฐัะฐะผะตััะฐะผะธ.

- **`mr_generate_key_pair()`**  
  ะะตะฝะตัะฐัะธั ะฝะพะฒะพะน X25519 ะบะปััะตะฒะพะน ะฟะฐัั (ะฟัะฑะปะธัะฝัะน + ะฟัะธะฒะฐัะฝัะน ะบะปัั).

- **`mr_session_create()`**  
  ะฃััะฐะฝะพะฒะบะฐ ะทะฐัะธััะฝะฝะพะน ัะตััะธะธ ั ัะดะฐะปัะฝะฝะพะน ััะพัะพะฝะพะน ะฝะฐ ะพัะฝะพะฒะต ะพะฑะผะตะฝะฐ ะฟัะฑะปะธัะฝัะผะธ ะบะปััะฐะผะธ.

- **`mr_encrypt()` / `mr_decrypt()`**  
  ะจะธััะพะฒะฐะฝะธะต ะธ ัะฐััะธััะพะฒะบะฐ ัะพะพะฑัะตะฝะธะน ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ัะฟัะฐะฒะปะตะฝะธะตะผ ะบะปััะฐะผะธ ะธ ะทะฐัะธัะพะน ะพั ะฟะพะฒัะพัะพะฒ.

- **`mr_key_update()`**  
  ะะปะฐะฝะพะฒะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ะบะปััะตะน (ะฝะฐะฟัะธะผะตั, ัะฐะท ะฒ N ัะพะพะฑัะตะฝะธะน).

- **`mr_emergency_key_update()`**  
  ะะฒะฐัะธะนะฝัะน ัะฑัะพั ะฒัะตั ะบะปััะตะน ะฟัะธ ะฟะพะดะพะทัะตะฝะธะธ ะฝะฐ ะบะพะผะฟัะพะผะตัะฐัะธั.

- **`mr_get_session_info()`**  
  ะะพะปััะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั ัะตััะธะธ: ัััััะธะบะธ, ID, ััะฐััั ะฐะบัะธะฒะฝะพััะธ.

- **`mr_error_string()`**  
  ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะบะพะดะพะฒ ะพัะธะฑะพะบ ะฒ ัะตะปะพะฒะตะบะพัะธัะฐะตะผัะต ัััะพะบะธ ะดะปั ะปะพะณะธัะพะฒะฐะฝะธั ะธ ะพัะปะฐะดะบะธ.

> ๐ ะะพะปะฝะพะต ะพะฟะธัะฐะฝะธะต ัะธะฟะพะฒ, ััััะบััั ะธ ะฒะพะทะฒัะฐัะฐะตะผัั ะทะฝะฐัะตะฝะธะน โ ะฒ ะทะฐะณะพะปะพะฒะพัะฝะพะผ ัะฐะนะปะต [`meshratchet.h`](meshratchet.h).

---

## ๐ ะะธัะตะฝะทะธั

MeshRatchet ัะฐัะฟัะพัััะฐะฝัะตััั ะฟะพะด ะฟัะพะฟัะธะตัะฐัะฝะพะน ะปะธัะตะฝะทะธะตะน **Mesh Security Labs License**.

- โ ะะตัะฟะปะฐัะฝะพ ะดะปั ะธััะปะตะดะพะฒะฐะฝะธะน, ะพะฑััะตะฝะธั ะธ ะฝะตะบะพะผะผะตััะตัะบะพะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.  
- ๐ผ ะะปั ะบะพะผะผะตััะตัะบะพะณะพ ะฒะฝะตะดัะตะฝะธั ััะตะฑัะตััั ะฟะธััะผะตะฝะฝะพะต ัะฐะทัะตัะตะฝะธะต.

๐ฉ **ะกะฒัะถะธัะตัั ั ะฝะฐะผะธ**: [@mesh_im](https://t.me/mesh_im)

---

## ๐ค ะะพะดะดะตัะถะบะฐ ะธ ะพะฑัะฐัะฝะฐั ัะฒัะทั

ะั ะพัะบัััั ะบ ัะพัััะดะฝะธัะตััะฒั ะธ ะณะพัะพะฒั ะฟะพะผะพัั:

- **Telegram**: [@mesh_im](https://t.me/mesh_im)  
- **Email**: `security@mesh.im` *(ัะพะปัะบะพ ัะตัะตะท ะพัะธัะธะฐะปัะฝัะต ะบะฐะฝะฐะปั)*  
- **ะััััั ะพะฑ ััะทะฒะธะผะพัััั**: ะฟัะธััะปะฐะนัะต ะฒ Telegram ั ะฟะพะผะตัะบะพะน **[SECURITY]**

> โ๏ธ **ะะฐะถะฝะพ**:  
> MeshRatchet **v0.1** โ ััะพ **ะฐะปััะฐ-ะฒะตััะธั**, ะฝะฐัะพะดััะฐััั ะฒ ะฐะบัะธะฒะฝะพะน ัะฐะทัะฐะฑะพัะบะต.  
> **ะะต ัะตะบะพะผะตะฝะดัะตััั** ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฒ production-ััะตะดะฐั ะฑะตะท ะฝะตะทะฐะฒะธัะธะผะพะณะพ ะบัะธะฟัะพะณัะฐัะธัะตัะบะพะณะพ ะฐัะดะธัะฐ.